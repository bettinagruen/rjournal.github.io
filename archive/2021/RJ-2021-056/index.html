<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
      <link rel="canonical" href="https://journal.r-project.org/archive/2021/RJ-2021-056/index.html" />
      <meta name="citation_journal_title" content="The R Journal" />
      <meta name="citation_issn" content="2073-4859" />
      
        <meta name="citation_author" content="Mark P.J. van der Loo" />
      

      <meta name="citation_title" content="A Method for Deriving Information from Running R Code" />
      <meta name="citation_date" content="2021" />
      
      <!-- <meta name="citation_doi" content="" /> -->
      <meta name="citation_abstract_html_url" content="https://journal.r-project.org/archive/2021/RJ-2021-056/index.html" />
      <meta name="citation_language" content="en" />
      <meta name="citation_fulltext_html_url" content="https://journal.r-project.org/archive/2021/RJ-2021-056/RJ-2021-056.pdf" />
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
    
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
  <title>Managing multiple data st... The R Journal</title>

  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/R.css" rel="stylesheet">
  <link href="/css/R-journal.css" rel="stylesheet">

  <link rel="alternate" type="application/rss+xml" title="R Journal RSS feed" href="/rss.atom">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body>

<div class="container page">
  <div class="row">
    <div class="col-xs-12 col-sm-offset-1 col-sm-2 sidebar" role="navigation">
      <h1><a href="/"><img src="/RLogo.png" width="101" height="77" alt="R" /></a></h1>

      <h2>Navigation</h2>
      <ul>
      
        
        <li class=""><a href="/archive/2020-2">Current Issue</a></li>
      
        
        <li class=""><a href="/archive/accepted/">Accepted articles</a></li>
      
        
        <li class=""><a href="/archive">Archive</a></li>
      
        
        <li class=""><a href="/archive/r-news.html">R News</a></li>
      
        
        <li class=""><a href="/archive/news-notes.html">News and Notes</a></li>
      
        
        <li class=""><a href="/submissions.html">Submissions</a></li>
      
        
        <li class=""><a href="/reviews-etc.html">Reviews and Proofreading</a></li>
      
        
        <li class=""><a href="/reviewer.html">Become a Reviewer</a></li>
      
        
        <li class=""><a href="/board.html">Editorial Board</a></li>
      
      </ul>

      <h2>Subscribe</h2>
      <p><a href="/rss.atom">RSS Feed <img src="/rss.png" width="13" height="13" alt="" /></a></p>
      <p>ISSN: 2073-4859</p>

    </div>

    <div class="col-xs-12 col-sm-7">
      





 

  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   

    
      <h2>The R Journal: accepted article</h2>
      This article will be copy edited and may be changed before publication.
      <br />
    
    <p class="article">
    <a href="RJ-2021-056.pdf" target="_blank">A Method for Deriving Information from Running R Code
    <img src="../../PDF-icon.png" width="25" height="24" alt="PDF download"/></a> <br />
    Mark P.J. van der Loo
    
    <p> Abstract It is often useful to tap secondary information from a running R script. Obvious use           cases include logging, and profiling of time or memory consuption. Perhaps less obvious cases           include tracking changes in R objects or collecting output of unit tests (assertions). In this paper we           demonstrate an approach that abstracts collection and processing of such secondary information from           the code in the running script. The approach is implemented in pure R, and allows users to control the           secondary information stream stream without global side effects and without altering existing code.           Although some elements of the approach discussed here have been applied in existing packages, the           combination of elements proposed here appears thus far to have been overlooked.             Introduction            The R language provides a convenient language to read, manipulate, and write data in the form           of scripts. As with any other scripted language, an R script gives description of data manipulation           activities, one after the other when read from top to bottom. The main advantage of a scripting           approach is that it makes each aspect of the data stream completely visible and explicit. This point           of strength also reflects as a weakness, namely every operation must necessarily be visible and           explicit. Some details can be hidden through regular means of abstraction including functions or           object-oriented data structures. But there are cases where functions or object types are not adequate           for hiding implementation details.               When we need to derive information about a running data processing script, creating a new           object type or function will not do because deriving that information implies we need to somehow           hamper with the process as it runs. As an example, consider a code fragment where the variable x is           manipulated.             x[x > threshold] <threshold             x[is.na(dat$x)] <median(x, na.rm=TRUE)           In the first statement every value above a certain threshold is replaced with the threshold, and next,           missing values are replaced with the median of the completed cases. It is interesting to know how an           aggregate of interest, say the mean of x, evolves as it gets processed. The instinctive way to do this is           to add statements to the script to collect the desired information as a function of process step.             meanx <mean(x, na.rm=TRUE)             x[x > threshold] <threshold             meanx <c(meanx, mean(x, na.rm=TRUE))             x[is.na(dat$x)] <median(x, na.rm=TRUE)             meanx <c(meanx, mean(x, na.rm=TRUE))           Obviously, this solution distracts from the main purpose of the script. It is also a repetitive task, which           validates some form of abstraction.               A more general picture of what we would like to achieve is given in Figure 1. The ‘primary data           stream’ is developed by a user as a script. In the previous example this is the processing of variable x.           When the script runs, some kind of logging information, which we label the ‘secondary data stream’ is           derived implicitly by an abstraction layer.               Creating an abstraction layer means that concerns between primary and secondary data streams           are separated as much as possible. In particular, we want to avoid inspecting or altering the user’s           code. Furthermore, we would like the user to have some control over the secondary stream from           within the script, for example to start, stop or parameterize the secondary stream. This should all           be done without any side effects. This means that the neither the user, nor the secondary stream           should have to manipulate or read global variables, options, or other environmental settings to convey           information from one stream to the other. Finally, we want to treat the availability of a secondary data           stream as a normal condition. This means we wish to avoid using signaling conditions (e.g. warnings           or errors) to convey information between the streams, unless there is an actual exceptional condition           such as an error.  </p>
    Received: 2019-10-20;
      online 2021-06-21<br />
    
    
    
    <br />

    
    </p><br />
    <img src="../../by.png" width="80" height="15" alt="CC BY 4.0" />
    <br />This article is licensed under a
    
    <a href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International license</a>.<br /><br /></p>
<pre>
@article{RJ-2021-056,
  author = {Mark P.J. van der Loo},
  title = {{A Method for Deriving Information from Running R Code}},
  year = {2021},
  journal = {{The R Journal}},
  doi = {10.32614/RJ-2021-056},
  url = {https://journal.r-project.org/archive/2021/RJ-2021-056/index.html}
}
</pre>

<br />

   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  
   
  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 


    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <footer>&copy; The R Foundation, <a href="mailto:r-journal@r-project.org">web page contact</a>.</footer>
    </div>
  </div>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40966673-1', 'r-project.org');
  ga('send', 'pageview');
</script>

</body>
</html>
